var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function i(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function c(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function l(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return d(" ")}function p(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function h(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let m;function g(t){m=t}function $(){if(!m)throw new Error("Function called outside component initialization");return m}const y=[],v=[],b=[],A=[],_=Promise.resolve();let j=!1;function w(t){b.push(t)}let x=!1;const k=new Set;function T(){if(!x){x=!0;do{for(let t=0;t<y.length;t+=1){const e=y[t];g(e),z(e.$$)}for(g(null),y.length=0;v.length;)v.pop()();for(let t=0;t<b.length;t+=1){const e=b[t];k.has(e)||(k.add(e),e())}b.length=0}while(y.length);for(;A.length;)A.pop()();j=!1,x=!1,k.clear()}}function z(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(w)}}const E=new Set;function F(t,e){-1===t.$$.dirty[0]&&(y.push(t),j||(j=!0,_.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function O(r,s,c,l,u,d,f=[-1]){const p=m;g(r);const h=s.props||{},$=r.$$={fragment:null,ctx:null,props:d,update:t,not_equal:u,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:[]),callbacks:n(),dirty:f,skip_bound:!1};let y=!1;if($.ctx=c?c(r,h,((t,e,...n)=>{const o=n.length?n[0]:e;return $.ctx&&u($.ctx[t],$.ctx[t]=o)&&(!$.skip_bound&&$.bound[t]&&$.bound[t](o),y&&F(r,t)),e})):[],$.update(),y=!0,o($.before_update),$.fragment=!!l&&l($.ctx),s.target){if(s.hydrate){const t=function(t){return Array.from(t.childNodes)}(s.target);$.fragment&&$.fragment.l(t),t.forEach(a)}else $.fragment&&$.fragment.c();s.intro&&((v=r.$$.fragment)&&v.i&&(E.delete(v),v.i(b))),function(t,n,r){const{fragment:s,on_mount:c,on_destroy:a,after_update:l}=t.$$;s&&s.m(n,r),w((()=>{const n=c.map(e).filter(i);a?a.push(...n):o(n),t.$$.on_mount=[]})),l.forEach(w)}(r,s.target,s.anchor),T()}var v,b;g(p)}function S(t,e,n){const o=t.slice();return o[5]=e[n],o}function B(t,e,n){const o=t.slice();return o[8]=e[n],o}function C(t){let e,n=Object.values(t[2]),o=[];for(let e=0;e<n.length;e+=1)o[e]=R(S(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=d("")},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);c(t,e,n)},p(t,i){if(5&i){let r;for(n=Object.values(t[2]),r=0;r<n.length;r+=1){const s=S(t,n,r);o[r]?o[r].p(s,i):(o[r]=R(s),o[r].c(),o[r].m(e.parentNode,e))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(t){l(o,t),t&&a(e)}}}function N(e){let n;return{c(){n=u("div"),n.innerHTML='<img src="/vector/three-dots.svg" width="40" height="10" alt=""/>',p(n,"class","placeholder")},m(t,e){c(t,n,e)},p:t,d(t){t&&a(n)}}}function P(t){let e,n,o,i,r,l,m=t[8].attributes[t[5].titleField.attributes.api_key]+"";function g(){return t[3](t[5],t[8])}return{c(){e=u("li"),n=u("a"),o=d(m),i=f(),p(n,"href",""),p(n,"class","edit-link svelte-1hnv56m")},m(t,a){var u,d,f,p,h;c(t,e,a),s(e,n),s(n,o),s(e,i),r||(d="click",h=g,f=function(t){return t.preventDefault(),h.call(this,t)},(u=n).addEventListener(d,f,p),l=()=>u.removeEventListener(d,f,p),r=!0)},p(e,n){t=e,4&n&&m!==(m=t[8].attributes[t[5].titleField.attributes.api_key]+"")&&h(o,m)},d(t){t&&a(e),r=!1,l()}}}function R(t){let e,n,o,i,r,m,g,$=t[5].name+"",y=t[5].items,v=[];for(let e=0;e<y.length;e+=1)v[e]=P(B(t,y,e));return{c(){e=u("section"),n=u("h3"),o=d($),i=d(" Records"),r=f(),m=u("ul");for(let t=0;t<v.length;t+=1)v[t].c();g=f(),p(e,"class","prose svelte-1hnv56m")},m(t,a){c(t,e,a),s(e,n),s(n,o),s(n,i),s(e,r),s(e,m);for(let t=0;t<v.length;t+=1)v[t].m(m,null);s(e,g)},p(t,e){if(4&e&&$!==($=t[5].name+"")&&h(o,$),5&e){let n;for(y=t[5].items,n=0;n<y.length;n+=1){const o=B(t,y,n);v[n]?v[n].p(o,e):(v[n]=P(o),v[n].c(),v[n].m(m,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=y.length}},d(t){t&&a(e),l(v,t)}}}function V(e){let n;function o(t,e){return t[1]?C:N}let i=o(e),r=i(e);return{c(){n=u("main"),r.c(),p(n,"class","plugin svelte-1hnv56m")},m(t,e){c(t,n,e),r.m(n,null)},p(t,[e]){i===(i=o(t))&&r?r.p(t,e):(r.d(1),r=i(t),r&&(r.c(),r.m(n,null)))},i:t,o:t,d(t){t&&a(n),r.d()}}}function X(t,e,n,o,i,r,s){try{var c=t[r](s),a=c.value}catch(t){return void n(t)}c.done?e(a):Promise.resolve(a).then(o,i)}function I(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){X(r,o,i,s,c,"next",t)}function c(t){X(r,o,i,s,c,"throw",t)}s(void 0)}))}}function q(t,e,n){var o,i,r,{plugin:s}=e;r=I((function*(){var{developmentMode:t,datoCmsApiToken:e}=s.parameters.global;s.startAutoResizer();var r,{getReferences:c,getItemTypeFields:a}=(r=e,{doQuery:t=>fetch("https://graphql.datocms.com/preview",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({query:t})}).then((t=>t.json())),getReferences:t=>fetch(`https://site-api.datocms.com/items/${t}/references`,{headers:{"X-Api-Version":3,Accept:"application/json",Authorization:`Bearer ${r}`}}).then((t=>t.json())),getItemTypeFields:t=>fetch(`https://site-api.datocms.com/item-types/${t}/fields`,{headers:{"X-Api-Version":3,Accept:"application/json",Authorization:`Bearer ${r}`}}).then((t=>t.json())),getItem:t=>fetch(`https://site-api.datocms.com/items/${t}`,{headers:{"X-Api-Version":3,Accept:"application/json",Authorization:`Bearer ${r}`}}).then((t=>t.json())),getField:t=>fetch(`https://site-api.datocms.com/fields/${t}`,{headers:{"X-Api-Version":3,Accept:"application/json",Authorization:`Bearer ${r}`}}).then((t=>t.json())),setField:(t,e)=>fetch(`https://site-api.datocms.com/fields/${t}`,{method:"PUT",headers:{"X-Api-Version":3,Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(e)}).then((t=>t.json()))}),l=yield c(s.itemId).catch(console.warn);n(2,i=yield l.data.reduce(function(){var t=I((function*(t,e,n){t=yield t;var o=e.relationships.item_type.data.id;if(null==t[String(o)]){var i=s.itemTypes[o],r=i.attributes.name,c=i.relationships.title_field.data.id,l=(yield a(o)).data.find((t=>t.id==c));t[String(o)]={id:o,name:r,titleField:l,items:[]}}return t[String(o)].items.push(e),t}));return function(e,n,o){return t.apply(this,arguments)}}(),{})),n(1,o=!0)})),$().$$.on_mount.push(r),function(t){$().$$.on_destroy.push(t)}((()=>{s&&s.stopAutoResizer()}));return t.$$set=t=>{"plugin"in t&&n(0,s=t.plugin)},[s,o,i,(t,e)=>s.navigateTo(`/editor/item_types/${t.id}/items/${e.id}/edit`)]}class L extends class{$destroy(){!function(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}{constructor(t){super(),O(this,t,q,V,r,{plugin:0})}}let M;return window.DatoCmsPlugin.init((t=>{t.startAutoResizer(),M=new L({target:document.body,props:{plugin:t}})})),M}();
//# sourceMappingURL=bundle.js.map
